{"version":3,"sources":["utils/numbers.ts","components/Avatar.tsx","components/TabletUsersBalances.tsx","components/SelectOptions.tsx","App.tsx","hooks/fetch.ts","utils/transactions.ts","index.js"],"names":["formatNumber","val","n","Decimal","equals","gte","toString","Avatar","props","uid","size","style","width","height","borderRadius","backgroundColor","overflow","dangerouslySetInnerHTML","__html","avatar","skeletonData","user_id","gbp","usd","eur","lastActivity","textColor","value","parseFloat","color","TabletUsersBalances","data","loading","error","rows","useMemo","Box","sx","p","Alert","severity","message","length","TableContainer","Table","minWidth","TableHead","TableRow","TableCell","padding","align","TableBody","map","row","border","Skeleton","variant","component","scope","SelectOptions","onChange","options","FormControl","Select","event","target","selectedOption","find","o","option","MenuItem","display","url","App","useState","setOption","response","setResponse","setError","setLoading","fetch","useCallback","a","undefined","delay","axios","get","resp","isAxiosError","useEffect","useFetch","usersBalancesData","transactions","users","Map","forEach","transaction","has","set","GBP","USD","EUR","timestamp","user","currency","add","amount","key","obj","dayjs","format","computeUsersBalances","handleChange","m","Paper","Toolbar","Typography","flex","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7f675b83.chunk.js","sourcesContent":["import Decimal from 'decimal.js'\n\nexport function formatNumber(val: Decimal | number){\n    // catches both type cases\n    const n = new Decimal(val)\n  \n    if (n.equals(0)) {\n      return '-'\n    }\n  \n    return `${n.gte(0) ? '+' : ''}${n.toString()}`\n  }","import avatar from \"gradient-avatar\";\n\ninterface Props {\n  uid: string;\n  size: number;\n}\n\nexport default function Avatar(props: Props) {\n  const { uid, size } = props;\n\n  return (\n    <div\n      style={{\n        width: size,\n        height: size,\n        borderRadius: size,\n        backgroundColor: \"lightgrey\",\n        overflow: \"hidden\",\n      }}\n      {...(props.uid && {\n        dangerouslySetInnerHTML: { __html: avatar(uid, size) },\n      })}\n    />\n  );\n}\n","import { useMemo } from \"react\";\n\nimport Box from \"@mui/material/Box\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport Table from \"@mui/material/Table\";\nimport TableBody from \"@mui/material/TableBody\";\nimport TableCell from \"@mui/material/TableCell\";\nimport TableHead from \"@mui/material/TableHead\";\nimport TableRow from \"@mui/material/TableRow\";\nimport Skeleton from \"@mui/material/Skeleton\";\nimport Alert from \"@mui/material/Alert\";\n\nimport { UserBalance } from \"../types/schema\";\n\nimport Avatar from \"./Avatar\";\n\nconst skeletonData: UserBalance[] = [\n  { user_id: '1', gbp: '0', usd: '0', eur: '0', lastActivity: '' },\n  { user_id: '2', gbp: '0', usd: '0', eur: '0', lastActivity: '' },\n  { user_id: '3', gbp: '0', usd: '0', eur: '0', lastActivity: '' },\n  { user_id: '4', gbp: '0', usd: '0', eur: '0', lastActivity: '' },\n  { user_id: '5', gbp: '0', usd: '0', eur: '0', lastActivity: '' },\n];\n\nfunction textColor(value: string) {\n  if (parseFloat(value) < 0) {\n    return { color: \"#ec535a\" };\n  }\n\n  if (parseFloat(value) > 0) {\n    return { color: \"#27a197\" };\n  }\n\n  return {}\n}\n\ninterface Props {\n  data: UserBalance[]\n  loading?: boolean\n  error?: Error\n}\n\nexport default function TabletUsersBalances(props: Props) {\n  const { data, loading, error } = props;\n\n  const rows = useMemo(() => {\n    if (loading) {\n      return skeletonData;\n    }\n\n    return data;\n  }, [data, loading]);\n\n  if (error) {\n    return (\n      <Box sx={{ p: 1 }}>\n        <Alert severity=\"error\">\n          {error.message}\n        </Alert>\n      </Box>\n    )\n  }\n\n  if (rows.length === 0) {\n    return (\n      <Box sx={{ p: 1 }}>\n        <Alert severity=\"info\">\n          No Transactions\n        </Alert>\n      </Box>\n    )\n  }\n\n  return (\n    <TableContainer>\n      <Table sx={{ minWidth: 650 }} aria-label=\"simple table\">\n        <TableHead>\n          <TableRow>\n            <TableCell padding=\"checkbox\"></TableCell>\n            <TableCell align=\"left\">User ID</TableCell>\n            <TableCell align=\"right\">GBP</TableCell>\n            <TableCell align=\"right\">USD</TableCell>\n            <TableCell align=\"right\">EUR</TableCell>\n            <TableCell align=\"right\">Last Activity</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {rows.map((row) => (\n            <TableRow\n              key={row.user_id}\n              sx={{ \"&:last-child td, &:last-child th\": { border: 0 } }}\n            >\n              <TableCell>\n                {loading \n                  ? <Skeleton variant=\"circular\" width={30} height={30} /> \n                  : <Avatar uid={row.user_id} size={30} />\n                }\n              </TableCell>\n              <TableCell component=\"th\" scope=\"row\">\n                {loading ? <Skeleton variant=\"text\" width={300} /> : row.user_id}\n              </TableCell>\n              <TableCell align=\"right\" sx={textColor(row.gbp)}>\n                {loading ? <Skeleton variant=\"text\" /> : row.gbp}\n              </TableCell>\n              <TableCell align=\"right\" sx={textColor(row.usd)}>\n                {loading ? <Skeleton variant=\"text\" /> : row.usd}\n              </TableCell>\n              <TableCell align=\"right\" sx={textColor(row.eur)}>\n                {loading ? <Skeleton variant=\"text\" /> : row.eur}\n              </TableCell>\n              <TableCell align=\"right\">\n                {loading ? <Skeleton variant=\"text\" /> : row.lastActivity}\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n  );\n}\n","import FormControl from \"@mui/material/FormControl\";\nimport MenuItem from \"@mui/material/MenuItem\";\nimport Select, { SelectChangeEvent } from \"@mui/material/Select\";\n\ntype Option = { value: string, display: string }\n\ninterface Props {\n  value: string\n  options: Option[]\n  onChange: (selectedOption: Option) => void\n}\n\nexport default function SelectOptions(props: Props) {\n  const { value, onChange, options } = props;\n\n  const handleChange = (event: SelectChangeEvent<string>) => {\n    const {\n      target: { value },\n    } = event;\n\n    if (onChange) {\n      const selectedOption = options.find((o) => o.value === value);\n\n      if (selectedOption) {\n        onChange(selectedOption);\n      }\n    }\n  };\n\n  return (\n    <FormControl sx={{ p: 1, width: 200 }}>\n      <Select value={value} onChange={handleChange}>\n        {options.map((option) => (\n          <MenuItem key={option.value} value={option.value}>\n            {option.display}\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n}\n","import { useState, useMemo, useCallback } from \"react\";\n\nimport Box from \"@mui/material/Box\";\nimport Paper from \"@mui/material/Paper\";\nimport Toolbar from \"@mui/material/Toolbar\";\nimport Typography from \"@mui/material/Typography\";\n\nimport { Transaction } from \"./types/schema\";\nimport { useFetch } from \"./hooks/fetch\";\nimport { computeUsersBalances } from \"./utils/transactions\";\nimport TabletUsersBalances from \"./components/TabletUsersBalances\";\nimport SelectOptions from \"./components/SelectOptions\";\n\nconst options = [\n  {\n    value: \"small\",\n    display: \"Small\",\n    url: \"http://localhost:3000/transactions-small.json\",\n  },\n  {\n    value: \"medium\",\n    display: \"Medium\",\n    url: \"http://localhost:3000/transactions-medium.json\",\n  },\n  {\n    value: \"large\",\n    display: \"Large\",\n    url: \"http://localhost:3000/transactions-large.json\",\n  },\n  {\n    value: \"xlarge\",\n    display: \"X-Large (404)\",\n    url: \"http://localhost:3000/transactions-x-large.json\",\n  },\n  {\n    value: \"empty\",\n    display: \"Empty\",\n    url: \"http://localhost:3000/transactions-empty.json\",\n  },\n];\n\nfunction App() {\n  const [option, setOption] = useState(options[0]);\n\n  const { data, error, loading } = useFetch<Transaction[]>(option.url);\n\n  const usersBalancesData = useMemo(\n    () => computeUsersBalances(data || []),\n    [data]\n  );\n\n  const handleChange = useCallback((selectedOption) => {\n    setOption(selectedOption);\n  }, []);\n\n  return (\n    <Box sx={{ m: 6 }}>\n      <Paper>\n        <Toolbar>\n          <Typography sx={{ flex: \"1 1 100%\" }} variant=\"h6\">\n            Transactions\n          </Typography>\n\n          <SelectOptions\n            value={option.value}\n            options={options}\n            onChange={handleChange}\n          />\n        </Toolbar>\n\n        <TabletUsersBalances\n          data={usersBalancesData}\n          loading={loading}\n          error={error}\n        />\n      </Paper>\n    </Box>\n  );\n}\n\nexport default App;\n","import { useEffect, useState, useCallback } from \"react\"\n\nimport axios, { AxiosResponse, AxiosError } from \"axios\"\nimport delay from 'delay'\n\nexport function useFetch<T>(url: string) {\n    const [response, setResponse] = useState<AxiosResponse<T>>()\n    const [error, setError] = useState<AxiosError>()\n    const [loading, setLoading] = useState(false)\n  \n    const fetch = useCallback(async (url) => {\n        setLoading(true)\n        setError(undefined)\n  \n        try {\n          // for demo purpose\n          await delay(1000)\n\n          const resp = await axios.get<T>(url)\n  \n          setResponse(resp)\n        } catch (error) {\n          if (axios.isAxiosError(error))  {\n            setError(error)\n          }\n        } finally {\n          setLoading(false)\n        }\n      }, []\n    )\n  \n    useEffect(() => {\n      fetch(url)\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [url])\n  \n    return {\n      ...response,\n      loading,\n      error\n    }\n  }","import Decimal from 'decimal.js'\nimport dayjs from 'dayjs'\n\nimport type { Transaction, UserBalance } from '../types/schema'\n\nimport { formatNumber } from './numbers'\n\ninterface UserBalanceRaw {\n  GBP: Decimal\n  USD: Decimal\n  EUR: Decimal\n  lastActivity: string          \n}\n\nexport function computeUsersBalances(transactions: Transaction[]): UserBalance[] {\n  const users = new Map<string, UserBalanceRaw>()\n\n  transactions.forEach((transaction) => {\n    // Initiate balances if user does not exist \n    if (!users.has(transaction.user_id)) {\n      users.set(transaction.user_id, {\n        GBP: new Decimal(0),\n        USD: new Decimal(0),\n        EUR: new Decimal(0),\n        lastActivity: transaction.timestamp,\n      })\n    }\n\n    const user = users.get(transaction.user_id)\n    \n    if (user) {\n      // Add to the right user's currency blance\n      user[transaction.currency] = user[transaction.currency].add(transaction.amount)\n      \n\n      // Overwrite date if latest\n      // HACK: JavaScript string comparison is able to do this \n      // but it's better using a library like dayjs or moment\n      if (transaction.timestamp > user.lastActivity) {\n       user.lastActivity = transaction.timestamp\n      }\n    }\n\n    return users\n  })\n\n  const arr = [...users].map(([key, obj]) => ({\n    user_id: key,\n    gbp: formatNumber(obj.GBP),\n    usd: formatNumber(obj.USD),\n    eur: formatNumber(obj.EUR),\n    lastActivity: dayjs(obj.lastActivity).format('DD-MM-YYYY')\n  }))\n\n  return arr\n}","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}